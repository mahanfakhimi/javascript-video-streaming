<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Streaming</title>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: cursive;
      }

      #videoPlayer {
        position: absolute;
        width: 100%;
        height: 100%;
        object-fit: cover;
        background-color: black;
      }

      #toggleButton {
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        padding: 1rem 5rem;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <video id="videoPlayer" autoplay playsinline></video>
    <button id="toggleButton">Start</button>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const videoPlayer = document.getElementById("videoPlayer");
        const toggleButton = document.getElementById("toggleButton");

        let stream;

        let isStreaming = false;

        const startStream = async () => {
          try {
            if (
              !navigator.mediaDevices ||
              !navigator.mediaDevices.getUserMedia
            ) {
              throw new Error("getUserMedia is not supported in this browser");
            }

            toggleButton.innerText = "Stop";

            stream = await navigator.mediaDevices.getUserMedia({
              video: true,
              audio: true,
            });

            videoPlayer.srcObject = stream;
          } catch (error) {
            console.error("Error accessing the camera:", error);
          }
        };

        const stopStream = async () => {
          try {
            toggleButton.innerText = "Start";

            if (stream) {
              const tracks = stream.getTracks();
              await Promise.all(tracks.map((track) => track.stop()));
              videoPlayer.srcObject = null;
            }
          } catch (error) {
            console.error("Error stopping the stream:", error);
          }
        };

        toggleButton.addEventListener("click", async () =>
          (isStreaming = !isStreaming)
            ? await startStream()
            : await stopStream()
        );
      });
    </script>
  </body>
</html>
